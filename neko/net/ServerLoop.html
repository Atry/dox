<!DOCTYPE html><html lang="en"><head><link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet"></link><script src="http://code.jquery.com/jquery-1.9.1.min.js"></script><script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script><link href="/dox/pages/styles.css" rel="stylesheet"></link><script type="text/javascript">var dox = {rootPath: "/dox/pages",platforms: ["cpp","cs","flash","flash8","java","js","neko","php"]};</script><script type="text/javascript" src="/dox/pages/nav.js"></script><script type="text/javascript" src="/dox/pages/index.js"></script><link rel="icon" href="favicon.ico" type="image/x-icon"></link><title>ServerLoop</title></head><body><div class="container-fluid"><div class="navbar navbar-inverse navbar-fixed-top"><div class="navbar-inner"><form class="navbar-search pull-left"><input id="search" type="text" class="search-query" placeholder="Search" autocomplete="off"></input></form><ul class="nav"><li id="select-version" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Version<b class="caret"></b></a><ul class="dropdown-menu"><li data="3_0"><a href="#">3.0</a></li><li data="3_1"><a href="#">3.1</a></li><li data="3_2"><a href="#">3.2</a></li></ul></li></ul><ul class="nav"><li id="select-platform" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Platform<b class="caret"></b></a><ul class="dropdown-menu"><li data="all"><a href="#">All Platforms</a></li><li data="cpp"><a href="#">cpp</a></li><li data="cs"><a href="#">cs</a></li><li data="flash"><a href="#">flash</a></li><li data="flash8"><a href="#">flash8</a></li><li data="java"><a href="#">java</a></li><li data="js"><a href="#">js</a></li><li data="neko"><a href="#">neko</a></li><li data="php"><a href="#">php</a></li></ul></li></ul></div></div><div class="row-fluid"><div id="nav"></div><div id="content"><h1><code><span class="directive">class </span>neko.net.ServerLoop&lt;ClientData&gt;</code></h1><div><code class="dark"><span class="macro">Available on neko</span></code></div><div class="doc"><p>This class enables you to quickly create a custom server that can
serve several clients in parallel. This server is using a single
thread and process so the server itself processing is not parallel.
Non-blocking sockets are used to ensure that a slow client does not
block the others.</p></div><h2>Class Fields</h2><div class="platform platform-neko"><a name="DEFAULT_BUFSIZE"></a><h3><code><span class="keyword">var</span> <a href="#DEFAULT_BUFSIZE">DEFAULT_BUFSIZE</a>:<a class="type" href="/dox/pages/Int.html">Int</a></code></h3><p>Each client has an associated buffer. This is the initial buffer size which
is set to 128 bytes by default.</p></div><div class="platform platform-neko"><a name="MAX_BUFSIZE"></a><h3><code><span class="keyword">var</span> <a href="#MAX_BUFSIZE">MAX_BUFSIZE</a>:<a class="type" href="/dox/pages/Int.html">Int</a></code></h3><p>Each client has an associated buffer. This is the maximum buffer size which
is set to 64K by default. When that size is reached and some data can't be processed,
the client is disconnected.</p></div><h2>Instance Fields</h2><div class="platform platform-neko"><a name="clients"></a><h3><code><span class="keyword">var</span> <a href="#clients">clients</a>:<a class="type" href="/dox/pages/List.html">List</a>&lt;<span class="type">ClientData</span>&gt;</code></h3><p></p></div><div class="platform platform-neko"><a name="listenCount"></a><h3><code><span class="keyword">var</span> <a href="#listenCount">listenCount</a>:<a class="type" href="/dox/pages/Int.html">Int</a></code></h3><p>This is the value of number client requests that the server socket
listen for. By default this number is 10 but can be increased for
servers supporting a large number of simultaneous requests.</p></div><div class="platform platform-neko"><a name="updateTime"></a><h3><code><span class="keyword">var</span> <a href="#updateTime">updateTime</a>:<a class="type" href="/dox/pages/Float.html">Float</a></code></h3><p>See [update].</p></div><div class="platform platform-neko"><a name="new"></a><h3><code><span class="keyword">function</span> <a href="#new">new</a>(newData:<a class="type" href="/dox/pages/sys/net/Socket.html">Socket</a> -&gt;<span class="type">ClientData</span>):<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>Creates a server instance. The [newData] methods must return
the data associated with the Client.</p></div><div class="platform platform-neko"><a name="clientDisconnected"></a><h3><code><span class="keyword">function</span> <a href="#clientDisconnected">clientDisconnected</a>(d:<span class="type">ClientData</span>):<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>This method is called after a client has been disconnected.</p></div><div class="platform platform-neko"><a name="clientWrite"></a><h3><code><span class="keyword">function</span> <a href="#clientWrite">clientWrite</a>(s:<a class="type" href="/dox/pages/sys/net/Socket.html">Socket</a>, buf:<a class="type" href="/dox/pages/haxe/io/Bytes.html">Bytes</a>, pos:<a class="type" href="/dox/pages/Int.html">Int</a>, len:<a class="type" href="/dox/pages/Int.html">Int</a>):<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>This method can be used instead of writing directly to the socket.
It ensures that all the data is correctly sent. If an error occurs
while sending the data, no exception will occur but the client will
be gracefully disconnected.</p></div><div class="platform platform-neko"><a name="closeConnection"></a><h3><code><span class="keyword">function</span> <a href="#closeConnection">closeConnection</a>(s:<a class="type" href="/dox/pages/sys/net/Socket.html">Socket</a>):<a class="type" href="/dox/pages/Bool.html">Bool</a></code></h3><p>Closes the client connection and removes it from the client List.</p></div><div class="platform platform-neko"><a name="onError"></a><h3><code><span class="keyword">function</span> <a href="#onError">onError</a>(e:Dynamic):<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>Called when an error occured. This enable you to log the error somewhere.
By default the error is displayed using [trace].</p></div><div class="platform platform-neko"><a name="processClientData"></a><h3><code><span class="keyword">function</span> <a href="#processClientData">processClientData</a>(d:<span class="type">ClientData</span>, buf:<a class="type" href="/dox/pages/haxe/io/Bytes.html">Bytes</a>, bufpos:<a class="type" href="/dox/pages/Int.html">Int</a>, buflen:<a class="type" href="/dox/pages/Int.html">Int</a>):<a class="type" href="/dox/pages/Int.html">Int</a></code></h3><p>This method is called when some data has been readed into a Client buffer.
If the data can be handled, then you can return the number of bytes handled
that needs to be removed from the buffer. It the data can't be handled (some
part of the message is missing for example), returns 0.</p></div><div class="platform platform-neko"><a name="run"></a><h3><code><span class="keyword">function</span> <a href="#run">run</a>(host:<a class="type" href="/dox/pages/sys/net/Host.html">Host</a>, port:<a class="type" href="/dox/pages/Int.html">Int</a>):<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>Run the server. This function should never return.</p></div><div class="platform platform-neko"><a name="update"></a><h3><code><span class="keyword">function</span> <a href="#update">update</a>():<a class="type" href="/dox/pages/Void.html">Void</a></code></h3><p>The [update] method is called after each socket event has been
processed or when [updateTime] has been reached. It can be used
to perform time-regular tasks such as pings. By default [updateTime]
is set to one second.</p></div></div></div></div></body></html>